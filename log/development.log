  [1m[36mLogUserStock Load (0.4ms)[0m  [1mSELECT `log_user_stocks`.* FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1[0m
  [1m[35mLogUserStock Load (0.4ms)[0m  SELECT stock_money*stock_amounts as total FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1
  [1m[36mLogUserStock Load (0.5ms)[0m  [1mSELECT stock_money*stock_amounts as total FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1 ORDER BY `log_user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mLogUserStock Load (0.5ms)[0m  SELECT stock_money*stock_amounts as total FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1
  [1m[36mLogUserStock Load (0.4ms)[0m  [1mSELECT stock_money*stock_amounts as total FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1 ORDER BY `log_user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SELECT SUM(total) AS sum_id FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1
Mysql2::Error: Unknown column 'total' in 'field list': SELECT SUM(total) AS sum_id FROM `log_user_stocks`  WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stock_money*stock_amounts as total) AS sum_id FROM `log_user_stocks`[0m
Mysql2::Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'as total) AS sum_id FROM `log_user_stocks`' at line 1: SELECT SUM(stock_money*stock_amounts as total) AS sum_id FROM `log_user_stocks`
  [1m[35m (0.3ms)[0m  SELECT SUM(total) AS sum_id FROM `log_user_stocks`
Mysql2::Error: Unknown column 'total' in 'field list': SELECT SUM(total) AS sum_id FROM `log_user_stocks`
  [1m[36mLogUserStock Load (0.5ms)[0m  [1mSELECT sum(stock_money*stock_amounts)/sum(stock_amounts) FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1[0m
  [1m[35mLogUserStock Load (0.5ms)[0m  SELECT sum(stock_money*stock_amounts)/sum(stock_amounts) as avg_money FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1
  [1m[36mLogUserStock Load (0.5ms)[0m  [1mSELECT sum(stock_money*stock_amounts)/sum(stock_amounts) as avg_money FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1 ORDER BY `log_user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mLogUserStock Load (0.3ms)[0m  SELECT sum(stock_money*stock_eamounts)/sum(stock_amounts) as avg_money FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1 ORDER BY `log_user_stocks`.`id` ASC LIMIT 1
Mysql2::Error: Unknown column 'stock_eamounts' in 'field list': SELECT  sum(stock_money*stock_eamounts)/sum(stock_amounts) as avg_money FROM `log_user_stocks`  WHERE `log_user_stocks`.`stock_id` = 63 AND `log_user_stocks`.`user_id` = 185 AND `log_user_stocks`.`stock_type` = 1  ORDER BY `log_user_stocks`.`id` ASC LIMIT 1
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1[0m
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1[0m
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users`[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 174 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 174 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (11.0ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 174, 97999)[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 175 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 175 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 175, 99999)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 176 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 176 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (31.7ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 176, 10936)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 177 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 177 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 177, 96839)
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 178 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 178 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 178, 99999)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 179 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 179 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (10.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 179, 82827)
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 180 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 180 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (10.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 180, 105999)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 181 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 181 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 181, 10043605)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 182 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 182 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 182, 526)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 183 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 183 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (10.9ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 183, 161500)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 184 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 184 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (1.7ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 184, 624)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 185 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 185 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 185, 1023492)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 186 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 186 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 186, 999999999)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 187 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 187 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (16.7ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 187, 1000316034)
  [1m[36m (16.7ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 188 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 188 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 188, 1009468779)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 189 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 189 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 189, 1000214832)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 190 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 190, 999999999)[0m
  [1m[35m (8.8ms)[0m  COMMIT
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 191 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 191 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-25 18:24:12', '2014-06-25 18:24:12', 191, 1000000099)
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[36mStock Load (0.4ms)[0m  [1mSELECT `stocks`.* FROM `stocks` INNER JOIN `issues` ON `issues`.`id` = `stocks`.`issue_id` WHERE (end_date >= CURDATE() AND is_closed = 0)[0m
  [1m[35m (14.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 63) AND (stock_type = 1)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 63) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (9.9ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `stock_selling`, `updated_at`) VALUES ('2014-06-25 18:37:06', 2, 63, 624, 2, '2014-06-25 18:37:06')[0m
  [1m[35m (3.0ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 64) AND (stock_type = 1)[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 64) AND (stock_type = 2)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `stock_selling`, `updated_at`) VALUES ('2014-06-25 18:37:06', 3, 64, 196, 2, '2014-06-25 18:37:06')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 65) AND (stock_type = 1)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 65) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-25 18:37:06', 1, 65, 785, '2014-06-25 18:37:06')[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 66) AND (stock_type = 1)[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 66) AND (stock_type = 2)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-25 18:37:06', 66, 5037, '2014-06-25 18:37:06')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 67) AND (stock_type = 1)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-25' AND stock_id = 67) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-25 18:37:06', 67, 5000, '2014-06-25 18:37:06')[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mStock Load (0.3ms)[0m  [1mSELECT `stocks`.* FROM `stocks` WHERE `stocks`.`issue_id` = 1234 LIMIT 1[0m
  [1m[36mStock Load (0.3ms)[0m  [1mSELECT `stocks`.* FROM `stocks` WHERE `stocks`.`issue_id` = 1060 LIMIT 1[0m
DEPRECATION WARNING: Calling #find(:all) is deprecated. Please call #all directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):3)
DEPRECATION WARNING: Relation#all is deprecated. If you want to eager-load a relation, you can call #load (e.g. `Post.where(published: true).load`). If you want to get an array of records from a relation, you can call #to_a (e.g. `Post.where(published: true).to_a`). (called from find at /usr/local/rvm/gems/ruby-2.0.0-p247/gems/activerecord-deprecated_finders-1.0.3/lib/active_record/deprecated_finders/relation.rb:103)
  [1m[35mStock Load (0.5ms)[0m  SELECT `stocks`.* FROM `stocks` WHERE (issue_id = 1060)
DEPRECATION WARNING: Calling #find(:all) is deprecated. Please call #all directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):4)
DEPRECATION WARNING: Relation#all is deprecated. If you want to eager-load a relation, you can call #load (e.g. `Post.where(published: true).load`). If you want to get an array of records from a relation, you can call #to_a (e.g. `Post.where(published: true).to_a`). (called from find at /usr/local/rvm/gems/ruby-2.0.0-p247/gems/activerecord-deprecated_finders-1.0.3/lib/active_record/deprecated_finders/relation.rb:103)
  [1m[36mStock Load (0.4ms)[0m  [1mSELECT `stocks`.* FROM `stocks` WHERE (issue_id = 1060)[0m
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users`[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 174 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 174 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (9.5ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 174, 97999)[0m
  [1m[35m (1.7ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 175 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 175 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (16.1ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 175, 99999)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 176 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 176 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (12.5ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 176, 10471)[0m
  [1m[35m (7.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 177 LIMIT 1[0m
  [1m[35m (8.8ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 177 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (17.0ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 177, 189619)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 178 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 178 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 178, 99999)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 179 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 179 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 179, 82827)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 180 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 180 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (8.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 180, 105999)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 181 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 181 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 181, 11429307)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 182 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 182 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (14.8ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 182, 0)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 183 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 183 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 183, 160800)
  [1m[36m (6.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 184 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 184 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (4.9ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 184, 666)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 185 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 185 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (6.5ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 185, 1045259)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 186 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 186 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (16.3ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 186, 999999999)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 187 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 187 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (9.8ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 187, 1000292049)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 188 LIMIT 1
  [1m[36m (4.8ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 188 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (8.9ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 188, 1009485479)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 189 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 189 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 189, 1000205752)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 190 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 190 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 190, 999999999)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 191 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 191 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 191, 1000000099)
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 192 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 192 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 192, 999923095)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 193 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 193 AND `user_stocks`.`is_settled` = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (3.8ms)[0m  INSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 193, 1000000048)
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 194 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(stocks.money*stock_amounts) AS sum_id FROM `user_stocks` INNER JOIN `stocks` ON `stocks`.`id` = `user_stocks`.`stock_id` WHERE `user_stocks`.`user_id` = 194 AND `user_stocks`.`is_settled` = 0[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (10.1ms)[0m  [1mINSERT INTO `log_users` (`created_at`, `updated_at`, `user_id`, `user_money`) VALUES ('2014-06-26 11:18:04', '2014-06-26 11:18:04', 194, 1000000045)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36mStock Load (0.3ms)[0m  [1mSELECT `stocks`.* FROM `stocks` INNER JOIN `issues` ON `issues`.`id` = `stocks`.`issue_id` WHERE (end_date >= CURDATE() AND is_closed = 0)[0m
  [1m[35m (38.8ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 63) AND (stock_type = 1)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 63) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (21.8ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 3, 63, 666, '2014-06-26 11:18:14')[0m
  [1m[35m (3.6ms)[0m  COMMIT
  [1m[36m (1.6ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 64) AND (stock_type = 1)[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 64) AND (stock_type = 2)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 3, 64, 186, '2014-06-26 11:18:14')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (6.5ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 65) AND (stock_type = 1)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 65) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_buying`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 2, 65, 746, '2014-06-26 11:18:14')[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 66) AND (stock_type = 1)[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 66) AND (stock_type = 2)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 66, 5000, '2014-06-26 11:18:14')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 67) AND (stock_type = 1)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 67) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 67, 5121, '2014-06-26 11:18:14')[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 70) AND (stock_type = 1)[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 70) AND (stock_type = 2)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 70, 2000, '2014-06-26 11:18:14')
  [1m[36m (0.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 71) AND (stock_type = 1)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `log_user_stocks` WHERE (DATE_FORMAT(created_at, '%Y-%m-%d') = '2014-06-26' AND stock_id = 71) AND (stock_type = 2)[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `log_stocks` (`created_at`, `stock_id`, `stock_money`, `updated_at`) VALUES ('2014-06-26 11:18:14', 71, 6666, '2014-06-26 11:18:14')[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE (issue_id = 1058)[0m
  [1m[35m (0.4ms)[0m  SELECT SUM(`user_stocks`.`stock_amounts`) AS sum_id FROM `user_stocks` WHERE (issue_id = 1058)
  [1m[36m (0.4ms)[0m  [1mSELECT SUM(`user_stocks`.`stock_amounts`) AS sum_id FROM `user_stocks` WHERE (issue_id = 1058 AND user_id = 194)[0m
  [1m[35m (0.4ms)[0m  SELECT SUM(`user_stocks`.`stock_amounts`) AS sum_id FROM `user_stocks` WHERE (issue_id = 1058 AND user_id = 192)
  [1m[36m (0.3ms)[0m  [1mSELECT SUM(`user_stocks`.`stock_amounts`) AS sum_id FROM `user_stocks` WHERE (issue_id = 1058 AND user_id = 195)[0m
  [1m[35m (0.4ms)[0m  SELECT SUM(`user_stocks`.`stock_amounts`) AS sum_id FROM `user_stocks` WHERE (issue_id = 1058 AND user_id = 19999)
  [1m[36mLogUserStock Load (11.4ms)[0m  [1mSELECT sum(stock_money*stock_amounts)/sum(stock_amounts) as avg_money FROM `log_user_stocks` WHERE `log_user_stocks`.`stock_id` = 66 AND `log_user_stocks`.`user_id` = 194 AND `log_user_stocks`.`stock_type` = 1 ORDER BY `log_user_stocks`.`id` ASC LIMIT 1[0m
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.5ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (2.9ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.3ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 191
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 191 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 195 ORDER BY `user_stocks`.`id` ASC LIMIT 1
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (1.1ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (11.6ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (0.5ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194
  [1m[36mUserStock Load (0.5ms)[0m  [1mSELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194[0m
  [1m[35mUserStock Load (0.4ms)[0m  SELECT stock_amounts FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):7)
  [1m[36mUserStock Load (0.5ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):8)
  [1m[35mUserStock Load (0.5ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):9)
  [1m[36mUserStock Load (0.5ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 193 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):10)
  [1m[35mUserStock Load (0.5ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 193 ORDER BY `user_stocks`.`id` ASC LIMIT 1
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):1)
  [1m[36mUserStock Load (0.5ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` IS NULL ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):2)
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 1 ORDER BY `user_stocks`.`id` ASC LIMIT 1
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):3)
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 1 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):4)
  [1m[35mUserStock Load (0.4ms)[0m  SELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1
DEPRECATION WARNING: Calling #find(:first) is deprecated. Please call #first directly instead. You have also used finder options. These are also deprecated. Please build a scope instead of using finder options. (called from irb_binding at (irb):5)
  [1m[36mUserStock Load (0.4ms)[0m  [1mSELECT `user_stocks`.* FROM `user_stocks` WHERE `user_stocks`.`stock_id` = 66 AND `user_stocks`.`user_id` = 194 ORDER BY `user_stocks`.`id` ASC LIMIT 1[0m
